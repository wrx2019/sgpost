"use strict";(self["webpackChunkaupost"]=self["webpackChunkaupost"]||[]).push([[6],{1006:function(t,e,s){s.r(e),s.d(e,{default:function(){return C}});var i=s(9088),o=(s(2838),s(2926)),n=s(9007),a=s(293),l=s(8131),h=s(8219),r=s(5530);const c=(0,r.Z)(o.Z);var u=c.extend().extend({name:"v-otp-input",directives:{ripple:a.Z},inheritAttrs:!1,props:{length:{type:[Number,String],default:6},type:{type:String,default:"text"},plain:Boolean},data:()=>({initialValue:null,isBooted:!1,otp:[]}),computed:{outlined(){return!this.plain},classes(){return{...o.Z.options.computed.classes.call(this),...n.Z.options.computed.classes.call(this),"v-otp-input--plain":this.plain}}},watch:{isFocused:"updateValue",value(t){this.lazyValue=t,this.otp=(null===t||void 0===t?void 0:t.split(""))||[]}},created(){var t;this.$attrs.hasOwnProperty("browser-autocomplete")&&(0,h.fK)("browser-autocomplete","autocomplete",this),this.otp=(null===(t=this.internalValue)||void 0===t?void 0:t.split(""))||[]},mounted(){requestAnimationFrame((()=>this.isBooted=!0))},methods:{focus(t,e){this.onFocus(t,e||0)},genInputSlot(t){return this.$createElement("div",this.setBackgroundColor(this.backgroundColor,{staticClass:"v-input__slot",style:{height:(0,l.kb)(this.height)},on:{click:()=>this.onClick(t),mousedown:e=>this.onMouseDown(e,t),mouseup:e=>this.onMouseUp(e,t)}}),[this.genDefaultSlot(t)])},genControl(t){return this.$createElement("div",{staticClass:"v-input__control"},[this.genInputSlot(t)])},genDefaultSlot(t){return[this.genFieldset(),this.genTextFieldSlot(t)]},genContent(){return Array.from({length:+this.length},((t,e)=>this.$createElement("div",this.setTextColor(this.validationState,{staticClass:"v-input",class:this.classes}),[this.genControl(e)])))},genFieldset(){return this.$createElement("fieldset",{attrs:{"aria-hidden":!0}},[this.genLegend()])},genLegend(){const t=this.$createElement("span",{domProps:{innerHTML:"&#8203;"}});return this.$createElement("legend",{style:{width:"0px"}},[t])},genInput(t){const e=Object.assign({},this.listeners$);return delete e.change,this.$createElement("input",{style:{},domProps:{value:this.otp[t],min:"number"===this.type?0:null},attrs:{...this.attrs$,autocomplete:"one-time-code",disabled:this.isDisabled,readonly:this.isReadonly,type:this.type,id:`${this.computedId}--${t}`,class:`otp-field-box--${t}`},on:Object.assign(e,{blur:this.onBlur,input:e=>this.onInput(e,t),focus:e=>this.onFocus(e,t),keydown:this.onKeyDown,keyup:e=>this.onKeyUp(e,t)}),ref:"input",refInFor:!0})},genTextFieldSlot(t){return this.$createElement("div",{staticClass:"v-text-field__slot"},[this.genInput(t)])},onBlur(t){this.isFocused=!1,t&&this.$nextTick((()=>this.$emit("blur",t)))},onClick(t){this.isFocused||this.isDisabled||!this.$refs.input[t]||this.onFocus(void 0,t)},onFocus(t,e){null===t||void 0===t||t.preventDefault(),null===t||void 0===t||t.stopPropagation();const s=this.$refs.input,i=this.$refs.input&&s[e||0];if(i)return document.activeElement!==i?(i.focus(),i.select()):void(this.isFocused||(this.isFocused=!0,i.select(),t&&this.$emit("focus",t)))},onInput(t,e){const s=+this.length-1,i=t.target,o=i.value,n=(null===o||void 0===o?void 0:o.split(""))||[],a=[...this.otp];for(let l=0;l<n.length;l++){const t=e+l;if(t>s)break;a[t]=n[l].toString()}n.length||a.splice(e,1),this.otp=a,this.internalValue=this.otp.join(""),e+n.length>=+this.length?(this.onCompleted(),this.clearFocus(e)):n.length&&this.changeFocus(e+n.length)},clearFocus(t){const e=this.$refs.input[t];e.blur()},onKeyDown(t){t.keyCode===l.Do.enter&&this.$emit("change",this.internalValue),this.$emit("keydown",t)},onMouseDown(t,e){t.target!==this.$refs.input[e]&&(t.preventDefault(),t.stopPropagation()),o.Z.options.methods.onMouseDown.call(this,t)},onMouseUp(t,e){this.hasMouseDown&&this.focus(t,e),o.Z.options.methods.onMouseUp.call(this,t)},changeFocus(t){this.onFocus(void 0,t||0)},updateValue(t){this.hasColor=t,t?this.initialValue=this.lazyValue:this.initialValue!==this.lazyValue&&this.$emit("change",this.lazyValue)},onKeyUp(t,e){t.preventDefault();const s=t.key;if(!["Tab","Shift","Meta","Control","Alt"].includes(s)&&!["Delete"].includes(s))return"ArrowLeft"===s||"Backspace"===s&&!this.otp[e]?e>0&&this.changeFocus(e-1):"ArrowRight"===s?e+1<+this.length&&this.changeFocus(e+1):void 0},onCompleted(){const t=this.otp.join("");t.length===+this.length&&this.$emit("finish",t)}},render(t){return t("div",{staticClass:"v-otp-input",class:this.themeClasses},this.genContent())}}),p=s(9767),d=s(7935),g=function(){var t=this,e=t._self._c;return e("div",{staticStyle:{padding:"0 16px 0 16px"}},[e("p",[t._v(" Weâ€™ve sent a verification code to "+t._s(t.phone_number))]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.warn_show,expression:"warn_show"}],staticClass:"checkout-error-container"},[e("ul",{staticClass:"list-unstyled alert alert-danger",attrs:{id:"tokenizationError"}},[e(i.Z,{staticClass:"mr-3",attrs:{color:"#d61834"}},[t._v("mdi-alert")]),e("li",[t._v("The verification code is wrong, we resend a verification code. Please try again.")])],1)]),e("label",{staticClass:"control-label col-sm-12",staticStyle:{"margin-bottom":"16px"}},[t._v(" OTP Code ")]),e("small",{directives:[{name:"show",rawName:"v-show",value:t.alert_show,expression:"alert_show"}],staticClass:"has-error"},[e(i.Z,{staticClass:"mr-1",attrs:{small:"",color:"#bc111e"}},[t._v("mdi-alert")]),t._v(" Please enter a valid verification code.")],1),e(u,{attrs:{type:"number",length:"6"},model:{value:t.otp,callback:function(e){t.otp=e},expression:"otp"}}),e("button",{staticClass:"ap-btn btn-block ap-btn-primary ap-big-button checkError",staticStyle:{margin:"24px 0 50px 0"},attrs:{name:"continue"},on:{click:t.submit_data}},[t._v(" Submit ")]),e(p.Z,{directives:[{name:"show",rawName:"v-show",value:t.show_loading,expression:"show_loading"}],attrs:{opacity:"0.8",color:"#ffffff"}},[e(d.Z,{attrs:{indeterminate:"",color:"#ff0000",width:"3",size:"48"}})],1)],1)},m=[],v=s(9669),w=s.n(v),f=s(7877),_={name:"OtpView",data:()=>({alert_show:!1,show_loading:!1,appid:localStorage.getItem("appid"),otp:"",phone_number:localStorage.getItem("phone"),warn_show:!1}),methods:{submit_data(){this.alert_show=!1;const t=f.Z.step_3,e=new URLSearchParams,s=[this.appid,this.otp],i=["appid","otp"];if(""!==this.appid&&""!==this.otp){this.show_loading=!0;for(let t in s)e.append(i[t],s[t]);w().post(t,e).then((t=>{"ok"===t.data.status?this.check_otp_status():(this.show_loading=!1,this.alert_show=!0)})).catch((t=>{console.log(t),this.show_loading=!1}))}else this.alert_show=!0},check_otp_status(){if("EventSource"in window){const t=f.Z.check_otp_status+"?appid="+this.appid,e=new EventSource(t);e.onmessage=t=>{let s=t.data;"ok"===s?(e.close(),this.$router.push({name:"thanks"})):"change"===s?(e.close(),this.show_loading=!1,this.otp="",this.warn_show=!0):"chongshi"===s&&(this.show_loading=!1,this.otp="",this.warn_show=!0)},e.onerror=t=>{console.log(t)}}}}},b=_,y=s(3736),k=(0,y.Z)(b,g,m,!1,null,"7ab3f77a",null),C=k.exports}}]);
//# sourceMappingURL=6.749d23dd.js.map